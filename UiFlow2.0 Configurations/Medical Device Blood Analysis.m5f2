{"version":"V2.0","versionNumber":"V2.3.4","type":"stickc-plus2","components":[{"name":"screen","type":"screen","layer":0,"screenId":"builtin","screenName":"","id":"__stickc-plus2_screen","createTime":1755674258645,"x":0,"y":0,"width":135,"height":240,"backgroundColor":"#000000","size":0,"isSelected":true},{"name":"label0","type":"label","layer":1,"screenId":"builtin","screenName":"","id":"nFa6VRDeAzKCiA2@","createTime":1755675460263,"x":10,"y":10,"color":"#ffffff","backgroundColor":"#222222","text":"HR:","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false},{"name":"label1","type":"label","layer":2,"screenId":"builtin","screenName":"","id":"jLKU7Wx^DEB$mvM#","createTime":1755675460263,"x":10,"y":40,"color":"#ffffff","backgroundColor":"#222222","text":"SpO2:","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false},{"name":"label2","type":"label","layer":3,"screenId":"builtin","screenName":"","id":"dxq+8L8!ORDaTVt&","createTime":1755675460263,"x":10,"y":70,"color":"#ffffff","backgroundColor":"#222222","text":"Gesture:","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false},{"name":"h_r","type":"label","layer":4,"screenId":"builtin","screenName":"","id":"qRevOH2M@%lnoV0-","createTime":1755675526707,"x":45,"y":10,"color":"#ffffff","backgroundColor":"#222222","text":"label3","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false},{"name":"spo2","type":"label","layer":5,"screenId":"builtin","screenName":"","id":"wOdGlhRJaz8wy%&2","createTime":1755675526707,"x":70,"y":40,"color":"#ffffff","backgroundColor":"#222222","text":"label3","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false},{"name":"gesture","type":"label","layer":6,"screenId":"builtin","screenName":"","id":"xfpPt^orkD!*-&RN","createTime":1755675526707,"x":95,"y":70,"color":"#ffffff","backgroundColor":"#222222","text":"label3","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false},{"name":"label3","type":"label","layer":7,"screenId":"builtin","screenName":"","id":"hP&xZ#tj1n$O$j$N","createTime":1755675969482,"x":10,"y":100,"color":"#ffffff","backgroundColor":"#222222","text":"Battery: ","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false},{"name":"bat","type":"label","layer":8,"screenId":"builtin","screenName":"","id":"tX5nJBYkinYL!A6s","createTime":1755675994400,"x":95,"y":100,"color":"#ffffff","backgroundColor":"#222222","text":"label4","font":"Widgets.FONTS.DejaVu18","rotation":0,"isSelected":false}],"resources":[{"hardware":["hardware_button","hardware_pin_button","imu","speaker","ir","i2c"]},{"unit":["unit_gesture","unit_heart"]}],"units":[{"type":"unit_gesture","name":"gesture_0","portList":["A","PAHUB","Custom"],"portType":"A","userPort":[22,21],"id":"nBTFBqY3`Z!f@qHM","createTime":1757146225057,"bus":"i2c0","pahubPortList":[0,1,2,3,4,5],"pahubPort":0,"initBlockId":"Eua;:~K^)a]A*tPW!`GR"},{"type":"unit_heart","name":"heart_0","portList":["A","PAHUB","Custom"],"portType":"A","userPort":[22,21],"id":"e0uU1IZ!=frLpswH","createTime":1757146225059,"bus":"i2c0","pahubPortList":[0,1,2,3,4,5],"pahubPort":0,"initBlockId":"L+Ag[3[u=IrNG[:]kCl|"}],"hats":[],"bases":[],"i2cs":[{"id":"i2c0","portType":"A","userPort":[22,21],"freq":"100000","blockId":"Vo,5l.:UH)W38Yvm=|L:"}],"blockly":"<block type=\"basic_on_setup\" id=\"setup_block\" deletable=\"false\" x=\"50\" y=\"50\"><mutation isBegin=\"true\"></mutation><field name=\"UPDATEOP\">true</field><statement name=\"FUNC\"><block type=\"system_m5_begin\" id=\"9:39,:/?G2g9/{3$x:Tf\"><next><block type=\"i2c_init\" id=\"Vo,5l.:UH)W38Yvm=|L:\"><field name=\"NAME\">1</field><field name=\"FREQ\">100000</field><value name=\"SCL\"><shadow type=\"math_number\" id=\"={(z!PL`5+7[MK@a5[T4\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">33</field></shadow></value><value name=\"SDA\"><shadow type=\"math_number\" id=\"*UUnNMe=*bT/s?(h-bEa\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">32</field></shadow></value><next><block type=\"unit_gesture_init\" id=\"Eua;:~K^)a]A*tPW!`GR\"><field name=\"NAME\">gesture_0</field><next><block type=\"unit_heart_init\" id=\"L+Ag[3[u=IrNG[:]kCl|\"><field name=\"NAME\">heart_0</field><value name=\"ADDR\"><shadow type=\"unit_heart_addr_option\" id=\"Um{2pSoeYC;:0g)XO%z`\"><field name=\"VALUE\">0x57</field></shadow></value><next><block type=\"unit_heart_deinit\" id=\"fzpdjoP;x=rxwg9aF#%q\"><field name=\"NAME\">heart_0</field></block></next></block></next></block></next></block></next></block></statement></block><block type=\"basic_on_loop\" id=\"loop_block\" deletable=\"false\" x=\"50\" y=\"290\"><mutation isUpdate=\"true\"></mutation><field name=\"UPDATEOP\">true</field><statement name=\"FUNC\"><block type=\"system_m5_update\" id=\"qdc5ZVd0W{Ou.g3/KLTb\"><next><block type=\"label_set_text\" id=\"Q${!cU#9z(~rx?^pB(5r\"><field name=\"NAME\">h_r</field><value name=\"TEXT\"><shadow type=\"text\" id=\"Q/kr3/tsLZKuX/!mmQY;\"><field name=\"TEXT\">Label</field></shadow><block type=\"unit_heart_get_heart_rate\" id=\"U2VY8JHdj,+]wwfl1!!^\"><field name=\"NAME\">heart_0</field></block></value><next><block type=\"label_set_text\" id=\"{F)$CHE9PzU()Ra?V}fQ\"><field name=\"NAME\">spo2</field><value name=\"TEXT\"><shadow type=\"text\" id=\"Q/kr3/tsLZKuX/!mmQY;\"><field name=\"TEXT\">Label</field></shadow><block type=\"unit_heart_get_spo2\" id=\"@X=u)ZlM{/?F52%[`i#v\"><field name=\"NAME\">heart_0</field></block></value><next><block type=\"label_set_text\" id=\"G.lc@G}KJhgNU39[VQ0B\"><field name=\"NAME\">gesture</field><value name=\"TEXT\"><shadow type=\"text\" id=\"Q/kr3/tsLZKuX/!mmQY;\"><field name=\"TEXT\">Label</field></shadow><block type=\"unit_gesture_get_hand_gestures\" id=\"[Z]2AEl{-+#N+qElH-wC\"><field name=\"NAME\">gesture_0</field></block></value><next><block type=\"label_set_text\" id=\"vD31PL87UFa9%-~a]1G5\"><field name=\"NAME\">bat</field><value name=\"TEXT\"><shadow type=\"text\" id=\"Q/kr3/tsLZKuX/!mmQY;\"><field name=\"TEXT\">Label</field></shadow><block type=\"power_get_battery_level\" id=\"SUY7Jp[J-F9.YM:lbn_7\"></block></value><next><block type=\"time_sleep_second\" id=\"YvVOz#Z0PO:?*n%?hfJw\"><value name=\"SECOND\"><shadow type=\"math_number\" id=\"VUCeEBCe+%j0.!3$F]jE\"><mutation max=\"Infinity\" min=\"0\" precision=\"0\"></mutation><field name=\"NUM\">5</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></statement></block>","screen":[{"simulationName":"Built-in","type":"builtin","width":135,"height":240,"scale":0.67,"screenName":"","blockId":"","screenColorType":0,"rotation":3,"id":"builtin","createTime":1755674258645}],"logicWhenNum":0,"pythonCode":"import os, sys, io\nimport M5\nfrom M5 import *\nfrom hardware import I2C\nfrom hardware import Pin\nfrom unit import GestureUnit\nfrom unit import HeartUnit\nimport time\n\nlabel0 = None\nlabel1 = None\nlabel2 = None\nh_r = None\nspo2 = None\ngesture = None\nlabel3 = None\nbat = None\ni2c0 = None\ngesture_0 = None\nheart_0 = None\n\ndef setup():\n  global label0, label1, label2, h_r, spo2, gesture, label3, bat, i2c0, gesture_0, heart_0\n\n  M5.begin()\n  Widgets.setRotation(3)\n  Widgets.fillScreen(0x000000)\n  label0 = Widgets.Label(\"HR:\", 10, 10, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n  label1 = Widgets.Label(\"SpO2:\", 10, 40, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n  label2 = Widgets.Label(\"Gesture:\", 10, 70, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n  h_r = Widgets.Label(\"label3\", 45, 10, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n  spo2 = Widgets.Label(\"label3\", 70, 40, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n  gesture = Widgets.Label(\"label3\", 95, 70, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n  label3 = Widgets.Label(\"Battery: \", 10, 100, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n  bat = Widgets.Label(\"label4\", 95, 100, 1.0, 0xffffff, 0x222222, Widgets.FONTS.DejaVu18)\n\n  i2c0 = I2C(0, scl=Pin(33), sda=Pin(32), freq=100000)\n  print('I2C scan:', i2c0.scan())  # Debug: Deve mostrare [87, 115]\n  \n  try:\n    gesture_0 = GestureUnit(i2c0)\n    print('Gesture init OK')\n  except Exception as e:\n    print('Errore Gesture init:', str(e))\n  \n  try:\n    heart_0 = HeartUnit(i2c0, 0x57)\n    heart_0.start()\n    print('Heart init OK')\n  except Exception as e:\n    print('Errore Heart init:', str(e))\n\ndef loop():\n  global label0, label1, label2, h_r, spo2, gesture, label3, bat, i2c0, gesture_0, heart_0\n  M5.update()\n  \n  try:\n    h_r.setText(str(heart_0.get_heart_rate()))\n    spo2.setText(str(heart_0.get_spo2()))\n  except Exception as e:\n    h_r.setText('Error')\n    spo2.setText('Error')\n    print('Errore lettura Heart:', str(e))\n  \n  try:\n    gest_val = gesture_0.get_gesture()\n    desc = gesture_0.gesture_description(gest_val)\n    gesture.setText(desc) \n  except Exception as e:\n    gesture.setText('Error')\n    print('Errore lettura Gesture:', str(e))\n  \n  bat.setText(str(Power.getBatteryLevel()))\n  time.sleep(5)\n\nif __name__ == '__main__':\n  try:\n    setup()\n    while True:\n      loop()\n  except (Exception, KeyboardInterrupt) as e:\n    try:\n      if heart_0:\n        heart_0.deinit()\n      from utility import print_error_msg\n      print_error_msg(e)\n    except ImportError:\n      print(\"please update to latest firmware\")","customList":[]}